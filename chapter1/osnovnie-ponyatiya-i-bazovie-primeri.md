# Основные понятия, установка, настройка, примеры работы.

---

## Введение

При построении сервис-ориентированной архитектуры встает вопрос обмена данными между компонентами системы. Это легко внедрением системы обмена сообщениями. Хорошим примером такой системы является [RabbitMQ](https://www.rabbitmq.com/).

RabbitMQ - это брокер сообщений, который управляет передачей сообщений в очереди.

## Основные понятия

**Exchange** - точка обмена сообщениями. Exchange играет ключевую роль в распределении сообщений, т.к. все сообщения которые не попали в какую либо очередь будут удалены. Маршрутеризация сообщений зависит от точки обмена.

**Fanout** - самый простой тип, сообщение будет передано по все очереди.

**Direct** - сообщение будет передано во все очереди с определенным ключем маршрута \(routing\_key\).

**Topic** - сообщение будет передано во все очереди с ключем маршута в виде шаблона.

**Queue** - очередь сообщений. Место куда подключается Consumer и получает сообщения. Если получателей нет - сообщения сохраняются в очереди.

**Message** - сообщение. Пакет бинарных данных с различными заготовками. У сообщения в очереди есть два состояния: Ready \(готово к доствке\) и Unacked \(в обработке/не подтвержено получение\). Сообщения в стейте Ready будут переданы следующему свободному получателю, Unacked - остается висеть в очереди, его дальнейшая передача другиму получателю блокируется, получение других сообщений получившему данное сообщение так же блокируется.

### Exchange

siteКонфигурация точки обмена решает дальнейшую судьбу сообщений. Тип fanout обычно применяется для уведомлений всех. Пример реальной жизни - чат. Отправитель \(producer\) написал в чат \(exchange\) сообщение и его получили по сети \(queues\) все полдписчики \(consumers\). Так же, в таком режиме работы игнорируется маршрут \(routing key\) сообщения.

Direct - позволяет нам рулить получением. К точке подключаются очереди с указанием маршрута и все переданные сообщения, имеющие такой же маршрут, будут переданы во все эти очереди.

Fanout - подписка по шаблону. Гибкая система передачи сообщений с указанием шаблона маршрута. Шаблон представляет собой строку с разделителями и знаками **\*** или **\#**, например, site.api.v2.orders.create, user.register, 127.0.0.1

```
. - разделитель
* - одно слово
# - любое количество слов

site.api.v2.orders.create
site.api.v2.*.delete
site.api.v3.#

127.0.0.*
89.108.#

/** ну мы же крутые парни */
* - одно слово, например ловить все сообщения от сайта ( api || front || mp || pizza )
# - god mode, око саурона, Ванга. Читать все сообщения.
    В этом режиме с данным типом точки обмена время жизни сервера RabbitMQ и получателей
    будет зависеть от параметров точки, параметров очередей, параметров сообщений,
    количества RAM, io и свободного места. Размер сообщениий так же будет влиять на сеть между mq
    и получателями.
```



## Установка и настройка

Установка, настройка, плагины

## Примеры



